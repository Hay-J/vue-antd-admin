(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4ad37eea"],{"01ef":function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{},[n("upload-file")],1)},r=[],i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("a-upload-dragger",{attrs:{accept:".xlsx, .xlc, .xlm, .xls",multiple:!1,action:"",showUploadList:!1,beforeUpload:e.beforeUpload}},[n("p",{staticClass:"ant-upload-drag-icon"},[n("a-icon",{attrs:{type:"inbox"}})],1),n("p",{staticClass:"ant-upload-text"},[e._v("单击或拖动文件到此区域上载")]),n("p",{staticClass:"ant-upload-hint"},[e._v(" 支持单个文件上传。 只能上传xlsx文件，且不超过500kb ")])])},l=[],o=n("1da1"),s=(n("96cf"),n("d81d"),n("ac1f"),n("1276"),n("b0c0"),n("d3b7"),n("b64b"),n("159b"),n("3dea")),c=n.n(s),u=function(e){return new Promise((function(t,n){var a=new FileReader;a.onload=function(e){var n=e.target.result,a=c.a.read(n,{type:"binary"}),r=[];a.SheetNames.forEach((function(e){r.push({sheetName:e,sheet:c.a.utils.sheet_to_json(a.Sheets[e])})})),t(r)},a.readAsBinaryString(e)}))},d={name:"Excel",data:function(){return{title:"批量添加",uploadColumn:{body:{field:"body",rule:this.$Rules.notNull("题干验证出错")},a:{field:"a"},b:{field:"b"},c:{field:"c"},d:{field:"d"},answer:{field:"answer"},note:{field:"note"}},tableDataUpload:[],percent:0,error:!1,errmsg:"数据验证出错",tableData:[{body:"题干内容",a:"A选项",b:"B选项",c:"C选项",d:"D选项",answer:"正确答案必须是数字（1:A,2:B,3:C,4:D）",note:"答案的解释（选填）"}]}},methods:{exportExcel:function(){var e=this;n.e("chunk-07bb8394").then(function(){var t=n("39a0"),a=t.export_json_to_excel,r=["body","a","b","c","d","answer","note"],i=["body","a","b","c","d","answer","note"],l=e.tableData,o=e.formatJson(i,l);a(r,o,"批量添加题库模板")}.bind(null,n)).catch(n.oe)},formatJson:function(e,t){return t.map((function(t){return e.map((function(e){return t[e]}))}))},beforeUpload:function(e,t){var n=this,a=e.name.split("."),r=a[a.length-1];["xlsx","xlc","xlm","xls","xlt"].some((function(e){return e===r}));return u(e).then(function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(t){var a,r,i,l,o,s,c,u,d,f;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(console.log("解析的数据",t[0]),n.tableDataUpload=[],n.percent=0,n.error=!1,e.prev=4,!(t&&t.length>0)){e.next=34;break}if(!t[0].sheet){e.next=34;break}a=t[0].sheet,r=99/a.length,i=0;case 10:if(!(i<a.length)){e.next=32;break}l={},o=0,s=Object.keys(n.uploadColumn);case 13:if(!(o<s.length)){e.next=27;break}if(c=s[o],u=n.uploadColumn[c],d=a[i][u.field],!u.rule){e.next=23;break}return e.next=20,n.$Rules.rule(u.rule,d);case 20:if(f=e.sent,!f){e.next=23;break}throw"第"+(i+1)+"行"+f;case 23:l[c]=d?"".concat(d):void 0;case 24:o++,e.next=13;break;case 27:n.tableDataUpload.push(l),n.percent=n.percent+r;case 29:i++,e.next=10;break;case 32:n.percent=100,console.log("tableDataUpload",n.tableDataUpload);case 34:e.next=41;break;case 36:e.prev=36,e.t0=e["catch"](4),n.errmsg=e.t0,n.error=!0,n.$notification.error({message:e.t0});case 41:case"end":return e.stop()}}),e,null,[[4,36]])})));return function(t){return e.apply(this,arguments)}}()),!1},onConfirm:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!(e.tableDataUpload.length>0)){t.next=13;break}return e.confirmLoading=!0,t.prev=2,t.next=5,e.$api.PostIssueList(e.tableDataUpload);case 5:n=t.sent,0===n.code?(e.$message.success("添加成功！"),e.$emit("success"),e.visible=!1):e.$message.error("添加失败！"+n.msg),t.next=12;break;case 9:t.prev=9,t.t0=t["catch"](2),e.$message.error("添加异常！"+t.t0.message);case 12:e.confirmLoading=!1;case 13:case"end":return t.stop()}}),t,null,[[2,9]])})))()},show:function(){this.tableDataUpload=[],this.percent=0,this.confirmLoading=!1,this.error=!1,this.visible=!0}}},f=d,p=n("2877"),h=Object(p["a"])(f,i,l,!1,null,null,null),b=h.exports,g={name:"Excel",data:function(){return{}},components:{UploadFile:b},computed:{},watch:{},methods:{},created:function(){},mounted:function(){}},x=g,m=Object(p["a"])(x,a,r,!1,null,"413db84a",null);t["default"]=m.exports},1276:function(e,t,n){"use strict";var a=n("2ba4"),r=n("c65b"),i=n("e330"),l=n("d784"),o=n("44e7"),s=n("825a"),c=n("1d80"),u=n("4840"),d=n("8aa5"),f=n("50c4"),p=n("577e"),h=n("dc4a"),b=n("f36a"),g=n("14c3"),x=n("9263"),m=n("9f7f"),v=n("d039"),w=m.UNSUPPORTED_Y,k=4294967295,y=Math.min,U=[].push,D=i(/./.exec),_=i(U),C=i("".slice),R=!v((function(){var e=/(?:)/,t=e.exec;e.exec=function(){return t.apply(this,arguments)};var n="ab".split(e);return 2!==n.length||"a"!==n[0]||"b"!==n[1]}));l("split",(function(e,t,n){var i;return i="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||".".split(/()()/).length>1||"".split(/.?/).length?function(e,n){var i=p(c(this)),l=void 0===n?k:n>>>0;if(0===l)return[];if(void 0===e)return[i];if(!o(e))return r(t,i,e,l);var s,u,d,f=[],h=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":""),g=0,m=new RegExp(e.source,h+"g");while(s=r(x,m,i)){if(u=m.lastIndex,u>g&&(_(f,C(i,g,s.index)),s.length>1&&s.index<i.length&&a(U,f,b(s,1)),d=s[0].length,g=u,f.length>=l))break;m.lastIndex===s.index&&m.lastIndex++}return g===i.length?!d&&D(m,"")||_(f,""):_(f,C(i,g)),f.length>l?b(f,0,l):f}:"0".split(void 0,0).length?function(e,n){return void 0===e&&0===n?[]:r(t,this,e,n)}:t,[function(t,n){var a=c(this),l=void 0==t?void 0:h(t,e);return l?r(l,t,a,n):r(i,p(a),t,n)},function(e,a){var r=s(this),l=p(e),o=n(i,r,l,a,i!==t);if(o.done)return o.value;var c=u(r,RegExp),h=r.unicode,b=(r.ignoreCase?"i":"")+(r.multiline?"m":"")+(r.unicode?"u":"")+(w?"g":"y"),x=new c(w?"^(?:"+r.source+")":r,b),m=void 0===a?k:a>>>0;if(0===m)return[];if(0===l.length)return null===g(x,l)?[l]:[];var v=0,U=0,D=[];while(U<l.length){x.lastIndex=w?0:U;var R,E=g(x,w?C(l,U):l);if(null===E||(R=y(f(x.lastIndex+(w?U:0)),l.length))===v)U=d(l,U,h);else{if(_(D,C(l,v,U)),D.length===m)return D;for(var $=1;$<=E.length-1;$++)if(_(D,E[$]),D.length===m)return D;U=v=R}}return _(D,C(l,v)),D}]}),!R,w)},"44e7":function(e,t,n){var a=n("861d"),r=n("c6b6"),i=n("b622"),l=i("match");e.exports=function(e){var t;return a(e)&&(void 0!==(t=e[l])?!!t:"RegExp"==r(e))}}}]);
//# sourceMappingURL=chunk-4ad37eea.e5c9d9e2.js.map